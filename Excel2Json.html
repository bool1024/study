<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<link rel="stylesheet" type="text/css" href="file:///${exe}/scripts/highlight.styles/${SyntaxHighlightStyleName}.css" />
		<style>
			body, table{font-family: 微软雅黑}
			
			table{border-collapse: collapse; border: 1px solid gray; border-width: 2px 1px 2px 1px;}
			th{border: 1px solid gray; padding: 4px; background-color: #ddd;}
			td{border: 1px solid gray; padding: 4px;}
			tr:nth-child(2n){background-color: #f8f8f8;}
			pre{border: 2px solid #d6d6d6; padding: 0px; border-radius: 3px;}
		</style>
	</head>
	<body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; ">
		<div>Excel2Json.html
		</div>
		<div>需要引入jquery组件才能正常运行
		</div>
		<div>
			<pre>
<code id="ID_16305CCEC90" class="lang-htmlbars hljs"><span class="xml"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh-CN"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>&gt;</span>
<span class="hljs-comment">&lt;!--&lt;script src="D:\NBI-progress\thirdjs\jquery-2.2.3.min.js"&gt;&lt;/script&gt;--&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"C:\Users\ywx521846\Desktop\jquery-1.8.3.js"</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"panel-heading"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h3</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"color:red;"</span>&gt;</span>excel转json<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>请在excel里复制下内容贴到上面一个文本框里<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"content"</span> <span class="hljs-attr">rows</span>=<span class="hljs-string">"10"</span>
        <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 100%;"</span> <span class="hljs-attr">spellcheck</span>=<span class="hljs-string">"false"</span>
        <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"请在excel里复制下内容贴到上面一个文本框里"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"changebtn"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"color:red;"</span>&gt;</span>转换<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"$('textarea').val('')"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"color:red;"</span>&gt;</span>清空<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"padding-top: 10px;"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"result"</span>  <span class="hljs-attr">rows</span>=<span class="hljs-string">"10"</span>
    <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 100%;"</span> <span class="hljs-attr">spellcheck</span>=<span class="hljs-string">"false"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"转换后的内容"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-keyword">var</span> fgf = <span class="hljs-regexp">/\t/</span>;
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ctyperow</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> txt = $(<span class="hljs-string">"#content"</span>).val();
    <span class="hljs-keyword">var</span> datas = txt.split(<span class="hljs-string">"\n"</span>);
    <span class="hljs-keyword">var</span> html = <span class="hljs-string">"[\n"</span>;
    <span class="hljs-keyword">var</span> keys = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; datas.length; i++) {
      <span class="hljs-keyword">var</span> ds = datas[i].split(fgf);
      <span class="hljs-keyword">if</span> (i == <span class="hljs-number">0</span>) {
          keys = ds;
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> (ds.length == <span class="hljs-number">0</span>)
          <span class="hljs-keyword">continue</span>;
        <span class="hljs-keyword">if</span> (ds.length == <span class="hljs-number">1</span>) {
          ds[<span class="hljs-number">0</span>] == <span class="hljs-string">""</span>;
          <span class="hljs-keyword">continue</span>;
        }
        html +=  <span class="hljs-string">"{"</span> ;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt; ds.length; j++) {
          <span class="hljs-keyword">var</span> d = ds[j];
          <span class="hljs-keyword">if</span> (d == <span class="hljs-string">""</span>)
            <span class="hljs-keyword">continue</span>;
          
            html += <span class="hljs-string">'"'</span> + keys[j] + <span class="hljs-string">'":"'</span> + d + <span class="hljs-string">'"'</span>;
          
          <span class="hljs-keyword">if</span> (j &lt; ds.length - <span class="hljs-number">1</span>) {
            html += <span class="hljs-string">','</span>;
          }
        }
        html +=  <span class="hljs-string">"}"</span>;
        <span class="hljs-keyword">if</span> (i &lt; datas.length - <span class="hljs-number">1</span>)
          html += <span class="hljs-string">",\n"</span>;
      }

    }
    html += <span class="hljs-string">"\n]"</span>;
    $(<span class="hljs-string">"#result"</span>).val(html);
  }	
  $(<span class="hljs-string">"#changebtn"</span>).click(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    ctyperow(<span class="hljs-literal">true</span>);
  });
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span></code></pre>
			<div><br />
			</div>
		</div>
	</body>
</html>
