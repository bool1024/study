<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<link rel="stylesheet" type="text/css" href="file:///${exe}/scripts/highlight.styles/${SyntaxHighlightStyleName}.css" />
		<style>
			table{border-collapse: collapse; border: 1px solid gray; border-width: 2px 1px 2px 1px;}
			th{border: 1px solid gray; padding: 4px; background-color: #ddd;}
			td{border: 1px solid gray; padding: 4px;}
			tr:nth-child(2n){background-color: #f8f8f8;}
			pre{border: 2px solid #d6d6d6; padding: 0px; border-radius: 3px;}
		</style>
	</head>
	<body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; ">
		<div>JAXP（Java API for XML Processing）：处理XML的Java API
		</div>
		<div><br />
		</div>
		<div>解析XML一般有两种方式：
		</div>
		<div>
			<ul>
				<li>DOM方式：一次性读取XML内容存入内存
					<ul>
						<li>优点：能进行各种增删改查操作
						</li>
						<li>缺点：占用内存大
						</li>
						<li>使用：给定需要读取的文件即可，读取出来之后再根据自己写的方法进行操作
						</li>
					</ul>
				</li>
				<li>SAX方式：顺序读取内容，碰到什么样的标签执行什么样的操作由自己定义
				</li>
				<ul>
					<li>优点：占用内存小
					</li>
					<li>缺点：不能进行葛洪增删改查操作，只能遍历出内容
					</li>
					<li>使用：给定需要读取的文件和一个操作集，操作集会指示在遍历的时候遇到什么标签做什么事
					</li>
				</ul>
			</ul>
			<div>对xml进行操作就是操作xml文件当中的元素和属性：&lt;元素 属性=&quot;属性值&quot;&gt;文本内容&lt;/&gt;
			</div>
			<div><br />
			</div>
			<div>由于元素里面的文本内容可以是子元素，而为了阅读方便通常都是另起一行并缩进的，造成了父元素和子元素之间由两段空格和一个换行，解析xml文档的时候识别不了，所以也会一并读取出来
			</div>
			<div><br />
			</div>
		</div>
		<div>1.XML文件示例：
		</div>
		<div>
			<pre>
<code id="ID_16366BF1D85" class="lang-xml hljs"><span class="php"><span class="hljs-meta">&lt;?</span>xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span><span class="hljs-meta">?&gt;</span></span>
<span class="hljs-tag">&lt;<span class="hljs-name">root</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">year</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"2017"</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- holiday节假日，有周末的可填可不填，workday补班 --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">holiday</span> <span class="hljs-attr">days</span>=<span class="hljs-string">"01-02,01-03,01-23,01-24,01-25,01-26,01-27,04-02,04-03,04-04,04-30,05-01,06-22,10-01,10-02,10-03,10-04,10-05"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">workday</span> <span class="hljs-attr">days</span>=<span class="hljs-string">"01-21,01-29,03-31,04-01,04-28,09-29"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">year</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">year</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"2018"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">holiday</span> <span class="hljs-attr">days</span>=<span class="hljs-string">"01-02,01-03,01-23,01-24,01-25,01-26,01-27,04-02,04-03,04-04,04-30,05-01,06-22,10-01,10-02,10-03,10-04,10-05"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">workday</span> <span class="hljs-attr">days</span>=<span class="hljs-string">"01-21,01-29,03-31,04-01,04-28,09-29"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">year</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">root</span>&gt;</span></code></pre>
			<div><br />
			</div>
			<div>2.DOM解析以及SAX解析（放在一个工具类中）
			</div>
			<div>
				<pre>
<code id="ID_16366C64D78" class="lang-java hljs"><ol><li><span class="hljs-keyword">package</span> holiday;</li><li></li><li><span class="hljs-keyword">import</span> java.io.File;</li><li><span class="hljs-keyword">import</span> java.io.IOException;</li><li><span class="hljs-keyword">import</span> java.util.HashMap;</li><li><span class="hljs-keyword">import</span> java.util.Map;</li><li></li><li><span class="hljs-keyword">import</span> javax.xml.parsers.DocumentBuilder;</li><li><span class="hljs-keyword">import</span> javax.xml.parsers.DocumentBuilderFactory;</li><li><span class="hljs-keyword">import</span> javax.xml.parsers.ParserConfigurationException;</li><li><span class="hljs-keyword">import</span> javax.xml.parsers.SAXParser;</li><li><span class="hljs-keyword">import</span> javax.xml.parsers.SAXParserFactory;</li><li></li><li><span class="hljs-keyword">import</span> org.w3c.dom.Document;</li><li><span class="hljs-keyword">import</span> org.w3c.dom.Element;</li><li><span class="hljs-keyword">import</span> org.w3c.dom.Node;</li><li><span class="hljs-keyword">import</span> org.w3c.dom.NodeList;</li><li><span class="hljs-keyword">import</span> org.xml.sax.Attributes;</li><li><span class="hljs-keyword">import</span> org.xml.sax.SAXException;</li><li><span class="hljs-keyword">import</span> org.xml.sax.helpers.DefaultHandler;</li><li></li><li><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HolidayUtils</span> </span>{</li><li>    </li><li>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Map&lt;String, String[]&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;String, String[]&gt;();</li><li>    </li><li>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> HolidayUtils instance = <span class="hljs-keyword">new</span> HolidayUtils();</li><li>    </li><li>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">HolidayUtils</span><span class="hljs-params">()</span></span>{</li><li>        <span class="hljs-comment">//parseXMLByDOM();</span></li><li>        parseXMLBySAX();</li><li>    }</li><li>    </li><li>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> HolidayUtils <span class="hljs-title">getInstance</span><span class="hljs-params">()</span></span>{</li><li>        <span class="hljs-keyword">return</span> instance;</li><li>    }</li><li>    </li><li>    <span class="hljs-keyword">public</span> Map&lt;String, String[]&gt; getHolidaysMap(){</li><li>        <span class="hljs-keyword">return</span> map;</li><li>    }</li><li>    </li><li>    <span class="hljs-comment">//java自带的DOM实现</span></li><li>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">parseXMLByDOM</span><span class="hljs-params">()</span></span>{</li><li>        <span class="hljs-keyword">try</span> {</li><li>            <span class="hljs-comment">//获取jaxp工厂</span></li><li>            DocumentBuilderFactory builderFactory = DocumentBuilderFactory.newInstance();</li><li>            <span class="hljs-comment">//获取解析器</span></li><li>            DocumentBuilder builder = builderFactory.newDocumentBuilder();</li><li>            <span class="hljs-comment">//用解析器加载xml文档 -&gt;Document</span></li><li>            Document document = builder.parse(<span class="hljs-keyword">new</span> File(<span class="hljs-string">"src/holidays.xml"</span>));</li><li>            <span class="hljs-comment">//Element root = document.getDocumentElement();</span></li><li>            NodeList nodeList = document.getElementsByTagName(<span class="hljs-string">"year"</span>);</li><li>            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; nodeList.getLength(); i++){</li><li>                Element yearNode = (Element)nodeList.item(i);</li><li>                String year = yearNode.getAttribute(<span class="hljs-string">"value"</span>);</li><li>                NodeList childNodes = yearNode.getChildNodes();</li><li>                <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; childNodes.getLength(); j++){</li><li>                    Node node = childNodes.item(j);</li><li>                    <span class="hljs-comment">//判断子节点是不是element元素类型（因为遍历过程中会遍历出空格和换行）</span></li><li>                    <span class="hljs-keyword">if</span>(node.getNodeType() == Node.ELEMENT_NODE){</li><li>                        Element child = (Element) node;</li><li>                        <span class="hljs-comment">//此处用child.getNodeName()也行</span></li><li>                        map.put(year+<span class="hljs-string">"_"</span>+node.getNodeName(), child.getAttribute(<span class="hljs-string">"days"</span>).split(<span class="hljs-string">","</span>));</li><li>                        <span class="hljs-comment">//注释代码可以解析&lt;name&gt;test&lt;/name&gt;中的test值</span></li><li>                        <span class="hljs-comment">/*if("test".equals(child.getNodeName())){</span></li><li>                            System.out.println(child.getTextContent());</li><li>                        }*/</li><li>                    }</li><li>                }</li><li>            }</li><li>        } <span class="hljs-keyword">catch</span> (ParserConfigurationException e) {</li><li>            e.printStackTrace();</li><li>        } <span class="hljs-keyword">catch</span> (SAXException e) {</li><li>            e.printStackTrace();</li><li>        } <span class="hljs-keyword">catch</span> (IOException e) {</li><li>            e.printStackTrace();</li><li>        }</li><li>    }</li><li>    <span class="hljs-comment">//java自带的SAX解析</span></li><li>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">parseXMLBySAX</span><span class="hljs-params">()</span></span>{</li><li>        <span class="hljs-comment">//1.获取解析器工程</span></li><li>        SAXParserFactory factory = SAXParserFactory.newInstance();</li><li>        <span class="hljs-keyword">try</span> {</li><li>            <span class="hljs-comment">//2.获取解析器</span></li><li>            SAXParser parser = factory.newSAXParser();</li><li>            <span class="hljs-comment">//3.解析文档</span></li><li>            parser.parse(<span class="hljs-keyword">new</span> File(<span class="hljs-string">"src/holidays.xml"</span>), <span class="hljs-keyword">new</span> SAXHandle());</li><li>        } <span class="hljs-keyword">catch</span> (ParserConfigurationException e) {</li><li>            e.printStackTrace();</li><li>        } <span class="hljs-keyword">catch</span> (SAXException e) {</li><li>            e.printStackTrace();</li><li>        } <span class="hljs-keyword">catch</span> (IOException e) {</li><li>            e.printStackTrace();</li><li>        }</li><li>    }</li><li>    </li><li>    //private 不能被外部HolidayUtils.getInstance().new SAXHandle()调用 &nbsp;</li><li><span class="hljs-keyword">    private</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SAXHandle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">DefaultHandler</span></span>{</li><li>        </li><li>        <span class="hljs-keyword">private</span> String year = <span class="hljs-string">""</span>;</li><li>        </li><li>        <span class="hljs-comment">//文档开始解析</span></li><li>        <span class="hljs-meta">@Override</span></li><li>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">startDocument</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SAXException </span>{</li><li>            System.out.println(<span class="hljs-string">"文档开始解析"</span>);</li><li>        }</li><li>        </li><li>        <span class="hljs-comment">//遇到元素开始解析，第三个参数时读取到的元素名称，第四个参数时读取到的元素的属性集</span></li><li>        <span class="hljs-meta">@Override</span></li><li>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">startElement</span><span class="hljs-params">(String uri, String localName, String qName, Attributes attributes)</span> <span class="hljs-keyword">throws</span> SAXException </span>{</li><li>            System.out.println(qName + <span class="hljs-string">"元素开始解析"</span>);</li><li>            System.out.println(uri + <span class="hljs-string">"--"</span> + localName + <span class="hljs-string">"--"</span> + qName + <span class="hljs-string">"--"</span>);</li><li>            <span class="hljs-keyword">if</span>(<span class="hljs-string">"year"</span>.equals(qName)){</li><li>                year = attributes.getValue(<span class="hljs-string">"value"</span>);</li><li>            }</li><li>            <span class="hljs-keyword">if</span>(<span class="hljs-string">"holiday"</span>.equals(qName) || <span class="hljs-string">"workday"</span>.equals(qName)){</li><li>                <span class="hljs-comment">//因为是按顺序读取，所以需要用到父节点信息的时候可以提前把父节点中的value属性放到一个全局变量中</span></li><li>                map.put(year+<span class="hljs-string">"_"</span>+qName, attributes.getValue(<span class="hljs-string">"days"</span>).split(<span class="hljs-string">","</span>));</li><li>            }</li><li>        }</li><li>        </li><li>        <span class="hljs-comment">//遇到文本开始解析，在xml文件里随便写一段不包含标签的文字则会走此方法</span></li><li>        <span class="hljs-meta">@Override</span></li><li>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">characters</span><span class="hljs-params">(<span class="hljs-keyword">char</span>[] ch, <span class="hljs-keyword">int</span> start, <span class="hljs-keyword">int</span> length)</span> <span class="hljs-keyword">throws</span> SAXException </span>{</li><li>            String str = <span class="hljs-keyword">new</span> String(ch, start, length).trim();</li><li>            <span class="hljs-keyword">if</span>(str.length() &gt; <span class="hljs-number">0</span>){</li><li>                System.out.println(<span class="hljs-string">"%%%%%%%%%%%%%"</span>+ str);</li><li>            }</li><li>        }</li><li>        </li><li>        <span class="hljs-comment">//元素解析结束</span></li><li>        <span class="hljs-meta">@Override</span></li><li>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">endElement</span><span class="hljs-params">(String uri, String localName, String qName)</span> <span class="hljs-keyword">throws</span> SAXException </span>{</li><li>            System.out.println(qName + <span class="hljs-string">"元素解析结束"</span>);</li><li>        }</li><li>        </li><li>        <span class="hljs-comment">//文档结束触发</span></li><li>        <span class="hljs-meta">@Override</span></li><li>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">endDocument</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SAXException </span>{</li><li>            System.out.println(<span class="hljs-string">"文档解析结束"</span>);</li><li>        }</li><li>    }</li><li>}</li></ol></code></pre>
				<div><br />
				</div>
			</div>
		</div>
	</body>
</html>
