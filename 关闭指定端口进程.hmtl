<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<link rel="stylesheet" type="text/css" href="file:///${exe}/scripts/highlight.styles/${SyntaxHighlightStyleName}.css" />
		<style>
			table{border-collapse: collapse; border: 1px solid gray; border-width: 2px 1px 2px 1px;}
			th{border: 1px solid gray; padding: 4px; background-color: #ddd;}
			td{border: 1px solid gray; padding: 4px;}
			tr:nth-child(2n){background-color: #f8f8f8;}
			pre{border: 2px solid #d6d6d6; padding: 0px; border-radius: 3px;}
		</style>
	</head>
	<body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; ">
		<div>
			<div>注意：记事本保存为ANSI格式，不然中文会乱码
			</div>
			<pre>
<code id="ID_16342C720B2" class="hljs dos">@<span class="hljs-built_in">echo</span> off
<span class="hljs-built_in">set</span> /p port=请输入要关闭的端口号：
<span class="hljs-keyword">for</span> /f "tokens=<span class="hljs-number">1</span>-<span class="hljs-number">5</span>" <span class="hljs-variable">%%i</span> <span class="hljs-keyword">in</span> ('netstat -ano^|<span class="hljs-built_in">findstr</span> ":<span class="hljs-variable">%port%</span>"') <span class="hljs-keyword">do</span> (
    <span class="hljs-built_in">echo</span> kill the process <span class="hljs-variable">%%m</span> who use the port <span class="hljs-variable">%port%</span>
    <span class="hljs-built_in">taskkill</span> /pid <span class="hljs-variable">%%m</span> -F
)
<span class="hljs-built_in">pause</span></code></pre>
			<div><br />
			</div>
			<div>循环读取一批端口，并查询对应PID是否存在，若存在则关闭
			</div>
			<div>
				<pre>
<code id="ID_1634309E402" class="hljs dos">@<span class="hljs-built_in">echo</span> off
<span class="hljs-keyword">for</span> /l <span class="hljs-variable">%%n</span> <span class="hljs-keyword">in</span> (<span class="hljs-number">20801</span>,<span class="hljs-number">1</span>,<span class="hljs-number">20812</span>) <span class="hljs-keyword">do</span> (
    @<span class="hljs-built_in">echo</span> <span class="hljs-built_in">find</span> the process which use port [<span class="hljs-variable">%%n</span>]
    <span class="hljs-keyword">for</span> /f "tokens=<span class="hljs-number">1</span>-<span class="hljs-number">5</span>" <span class="hljs-variable">%%i</span> <span class="hljs-keyword">in</span> ('netstat -ano^|<span class="hljs-built_in">findstr</span> ":<span class="hljs-variable">%%n</span>"') <span class="hljs-keyword">do</span> (
        tasklist /FI "PID eq <span class="hljs-variable">%%m</span>"|<span class="hljs-built_in">find</span> /i "PID" &amp;&amp; (
        <span class="hljs-built_in">echo</span> PID:<span class="hljs-variable">%%m</span> 运行中,kill the process [<span class="hljs-variable">%%m</span>] who use the port [<span class="hljs-variable">%%n</span>]
        <span class="hljs-built_in">taskkill</span> /F /pid <span class="hljs-variable">%%m</span>
        ) || <span class="hljs-built_in">echo</span> PID:<span class="hljs-variable">%%m</span> 未运行 
    )
)</code></pre>
				<div><br />
				</div>
			</div>
		</div>
	</body>
</html>
