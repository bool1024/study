<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<link rel="stylesheet" type="text/css" href="file:///${exe}/scripts/highlight.styles/${SyntaxHighlightStyleName}.css" />
		<style>
			table{border-collapse: collapse; border: 1px solid gray; border-width: 2px 1px 2px 1px;}
			th{border: 1px solid gray; padding: 4px; background-color: #ddd;}
			td{border: 1px solid gray; padding: 4px;}
			tr:nth-child(2n){background-color: #f8f8f8;}
			pre{border: 2px solid #d6d6d6; padding: 0px; border-radius: 3px;}
		</style>
	</head>
	<body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; ">
		<div>
			<div><span style="font-family: 微软雅黑;">Dom4J示例</span>
			</div>
			<pre>
<code id="ID_16385B5F2A8" class="lang-java hljs"><ol><li><span class="hljs-keyword">package</span> dom4j;</li><li></li><li><span class="hljs-keyword">import</span> java.io.FileOutputStream;</li><li><span class="hljs-keyword">import</span> java.util.List;</li><li></li><li><span class="hljs-keyword">import</span> org.dom4j.Attribute;</li><li><span class="hljs-keyword">import</span> org.dom4j.Document;</li><li><span class="hljs-keyword">import</span> org.dom4j.DocumentHelper;</li><li><span class="hljs-keyword">import</span> org.dom4j.Element;</li><li><span class="hljs-keyword">import</span> org.dom4j.io.OutputFormat;</li><li><span class="hljs-keyword">import</span> org.dom4j.io.SAXReader;</li><li><span class="hljs-keyword">import</span> org.dom4j.io.XMLWriter;</li><li></li><li><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Dom4j</span> </span>{</li><li>    <span class="hljs-comment">/**</span></li><li>     * 创建一个xml</li><li>     * <span class="hljs-doctag">@throws</span> Exception</li><li>     */</li><li>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception</span>{</li><li>        <span class="hljs-comment">//1.创建一个Document</span></li><li>        Document document = DocumentHelper.createDocument();</li><li>        <span class="hljs-comment">//2.给Document添加数据</span></li><li>        Element root = document.addElement(<span class="hljs-string">"DataSource"</span>);</li><li>        <span class="hljs-comment">//添加注释信息</span></li><li>        root.addComment(<span class="hljs-string">"这是注释信息"</span>);</li><li>        <span class="hljs-comment">//添加namespace</span></li><li>        root.addNamespace(<span class="hljs-string">"xsi"</span>, <span class="hljs-string">"http://www.compass-project.org/schema/core-config"</span>);</li><li>        <span class="hljs-comment">//在root根节点下面添加一个子节点</span></li><li>        Element database = root.addElement(<span class="hljs-string">"database"</span>);</li><li>        database.addAttribute(<span class="hljs-string">"name"</span>, <span class="hljs-string">"mysql"</span>);</li><li>        database.addAttribute(<span class="hljs-string">"version"</span>, <span class="hljs-string">"5.0"</span>);</li><li>        <span class="hljs-comment">//添加子节点</span></li><li>        database.addElement(<span class="hljs-string">"driver"</span>).setText(<span class="hljs-string">"com.mysql.jdbc.Driver"</span>);</li><li>        database.addElement(<span class="hljs-string">"url"</span>).setText(<span class="hljs-string">"jdbc:mysql://localhost:3306/myjdbc"</span>);</li><li>        database.addElement(<span class="hljs-string">"user"</span>).setText(<span class="hljs-string">"root"</span>);</li><li>        database.addElement(<span class="hljs-string">"password"</span>).setText(<span class="hljs-string">"test"</span>);</li><li>        <span class="hljs-comment">//3.将Document写入文件</span></li><li>        OutputFormat format = OutputFormat.createPrettyPrint();</li><li>        format.setEncoding(<span class="hljs-string">"utf-8"</span>);</li><li>        <span class="hljs-comment">//FileOutputStream默认生成的路径在根路径</span></li><li>        XMLWriter xmlWriter = <span class="hljs-keyword">new</span> XMLWriter(<span class="hljs-keyword">new</span> FileOutputStream(<span class="hljs-string">"d:/db.xml"</span>), format);</li><li>        xmlWriter.write(document);</li><li>        xmlWriter.close();</li><li>    }</li><li>    </li><li>    <span class="hljs-comment">/**</span></li><li>     * 解析xml，根据传入的文件来遍历该xml</li><li>     * <span class="hljs-doctag">@param</span> fileName</li><li>     * <span class="hljs-doctag">@throws</span> Exception</li><li>     */</li><li>    <span class="hljs-meta">@SuppressWarnings</span>(<span class="hljs-string">"unchecked"</span>)</li><li>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">read</span><span class="hljs-params">(String fileName)</span> <span class="hljs-keyword">throws</span> Exception</span>{</li><li>        <span class="hljs-comment">//sax解析器</span></li><li>        SAXReader saxReader = <span class="hljs-keyword">new</span> SAXReader();</li><li>        <span class="hljs-comment">//读取对象</span></li><li>        Document document = saxReader.read(fileName);</li><li>        <span class="hljs-comment">//得到根节点</span></li><li>        Element root = document.getRootElement();</li><li>        <span class="hljs-comment">//当不知道根节点的节点名称时</span></li><li>        List&lt;Element&gt; childElements = root.elements(<span class="hljs-string">"database"</span>);</li><li>        <span class="hljs-keyword">for</span>(Element child: childElements){</li><li>            <span class="hljs-comment">//获取属性，不知道属性名称时的遍历方法</span></li><li>            List&lt;Attribute&gt; attributes = child.attributes();</li><li>            <span class="hljs-keyword">for</span>(Attribute attribute: attributes){</li><li>                System.out.println(attribute.getName() + <span class="hljs-string">":"</span> + attribute.getValue());</li><li>            }</li><li>            String name = child.attributeValue(<span class="hljs-string">"name"</span>);</li><li>            String version = child.attribute(<span class="hljs-string">"version"</span>).getValue();</li><li>            System.out.println(name + <span class="hljs-string">":"</span> + version);</li><li>            </li><li>            <span class="hljs-comment">//获取子节点</span></li><li>            List&lt;Element&gt; childs = child.elements();</li><li>            <span class="hljs-keyword">for</span>(Element element: childs){</li><li>                System.out.println(element.getName() + <span class="hljs-string">":"</span> + element.getText());</li><li>            }</li><li>            System.out.println(child.elementText(<span class="hljs-string">"driver"</span>));</li><li>            System.out.println(child.element(<span class="hljs-string">"url"</span>).getText());</li><li>            System.out.println(child.elementTextTrim(<span class="hljs-string">"user"</span>));</li><li>            System.out.println(child.element(<span class="hljs-string">"password"</span>).getTextTrim());</li><li>        }</li><li>        </li><li>    }</li><li>    </li><li>    <span class="hljs-comment">/**</span></li><li>     * 对传入的xml进行修改</li><li>     * <span class="hljs-doctag">@param</span> fileName</li><li>     * <span class="hljs-doctag">@throws</span> Exception</li><li>     */</li><li>    <span class="hljs-meta">@SuppressWarnings</span>(<span class="hljs-string">"unchecked"</span>)</li><li>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">(String fileName)</span> <span class="hljs-keyword">throws</span> Exception</span>{</li><li>        <span class="hljs-comment">//SAX解析器</span></li><li>        SAXReader saxReader = <span class="hljs-keyword">new</span> SAXReader();</li><li>        <span class="hljs-comment">//读取对象</span></li><li>        Document document = saxReader.read(fileName);</li><li>        Element root = document.getRootElement();</li><li>        List&lt;Element&gt; databases = root.elements(<span class="hljs-string">"database"</span>);</li><li>        <span class="hljs-keyword">for</span>(Element database: databases){</li><li>            <span class="hljs-keyword">if</span>(<span class="hljs-string">"mysql"</span>.equalsIgnoreCase(database.attributeValue(<span class="hljs-string">"name"</span>))){</li><li>                database.attribute(<span class="hljs-string">"name"</span>).setText(<span class="hljs-string">"Oracle"</span>);</li><li>                database.element(<span class="hljs-string">"driver"</span>).setText(<span class="hljs-string">"oracle"</span>);</li><li>                database.element(<span class="hljs-string">"url"</span>).setText(<span class="hljs-string">"jdbc"</span>);</li><li>                <span class="hljs-comment">//删除password节点</span></li><li>                database.remove(database.element(<span class="hljs-string">"password"</span>));</li><li>                <span class="hljs-comment">//删除属性</span></li><li>                database.remove(database.attribute(<span class="hljs-string">"version"</span>));</li><li>            }</li><li>        }</li><li>        OutputFormat format = OutputFormat.createPrettyPrint();</li><li>        format.setEncoding(<span class="hljs-string">"utf-8"</span>);</li><li>        XMLWriter xmlWriter = <span class="hljs-keyword">new</span> XMLWriter(<span class="hljs-keyword">new</span> FileOutputStream(<span class="hljs-string">"d:/db2.xml"</span>), format);</li><li>        xmlWriter.write(document);</li><li>        xmlWriter.close();</li><li>    }</li><li>    </li><li>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception</span>{</li><li>        <span class="hljs-comment">//add();</span></li><li>        <span class="hljs-comment">//read("d:/db.xml");</span></li><li>        update(<span class="hljs-string">"d:/db.xml"</span>);</li><li>    }</li><li>}</li><li></li></ol></code></pre>
			<div><br />
			</div>
		</div>
	</body>
</html>
