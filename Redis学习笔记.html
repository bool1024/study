<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<style>
			body, table{font-family: 微软雅黑}
			
			table{border-collapse: collapse; border: 1px solid gray; border-width: 2px 1px 2px 1px;}
			th{border: 1px solid gray; padding: 4px; background-color: #ddd;}
			td{border: 1px solid gray; padding: 4px;}
			tr:nth-child(2n){background-color: #f8f8f8;}
			pre{border: 2px solid #d6d6d6; padding: 0px; border-radius: 3px;}
		</style>
	</head>
	<body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; ">
		<div>
			<p style="padding: 0px; margin: 0cm 0cm 8pt 18pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; text-indent: -18pt; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">1、<span style="padding: 0px; margin: 0px; list-style-type: none; line-height: normal; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; font-family: 'Times New Roman'; font-stretch: normal;"><span>&nbsp;</span></span></span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">什么是</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">redis</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt 18pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0cm; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">Redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">是一个数据库，他和我们传统的</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">oracle</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">数据库差别是它是基于内存的数据库；因为是基于内存，所以效率就高，在某些场景下就可以对我们传统的关系型数据库做一个补充</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt 18pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; text-indent: -18pt; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">2、<span style="padding: 0px; margin: 0px; list-style-type: none; line-height: normal; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; font-family: 'Times New Roman'; font-stretch: normal;"><span>&nbsp;</span></span></span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">怎么存储数据</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt 18pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0cm; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">基于</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">key-value</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">（键值）来存储数据，它不像关系型数据库那样有数据表，能提供</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">sql</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">查询。</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">存储的是</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 17.12px; color: black; font-family: 宋体; font-size: 12pt;">相对原始的数据集合及数据类型。</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">&nbsp;</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">3</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">、</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">Redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">基于</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">key-value</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">存储数据，那么</span><strong style="padding: 0px; margin: 0px; list-style-type: none;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 17.12px; color: black; font-family: 宋体; font-size: 12pt;">key</span></strong><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 17.12px; color: black; font-family: 宋体; font-size: 12pt;">-value</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 17.12px; color: black; font-family: 宋体; font-size: 12pt;">具体是什么？</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt 18pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0cm; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">&nbsp;key-valu</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 17.12px; color: black; font-family: 宋体; font-size: 12pt;">e</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 17.12px; color: black; font-family: 宋体; font-size: 12pt;">是一一对应的（键值对），一个<span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">key</span>只有一个<span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">value</span>值，你要找到<span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">value</span>值的话，就需要知道<span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">key</span>是什么，通过<span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">key</span>去找<span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">value.<br style="padding: 0px; margin: 0px; list-style-type: none;" /></span>键（<span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">key</span>）<span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">&nbsp;<span>&nbsp;</span></span>值（<span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">value</span>）</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 17.12px; color: rgb(0, 0, 240); font-family: 宋体; font-size: 12pt;"><br style="padding: 0px; margin: 0px; list-style-type: none;" /></span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 17.12px; color: black; font-family: 宋体; font-size: 12pt;">1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;</span></span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 17.12px; color: black; font-family: 宋体; font-size: 12pt;">我</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 17.12px; color: rgb(0, 0, 240); font-family: 宋体; font-size: 12pt;"><br style="padding: 0px; margin: 0px; list-style-type: none;" /></span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 17.12px; color: black; font-family: 宋体; font-size: 12pt;">2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;</span></span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 17.12px; color: black; font-family: 宋体; font-size: 12pt;">你</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 17.12px; color: rgb(0, 0, 240); font-family: 宋体; font-size: 12pt;"><br style="padding: 0px; margin: 0px; list-style-type: none;" /></span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 17.12px; color: black; font-family: 宋体; font-size: 12pt;">3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;</span></span><strong style="padding: 0px; margin: 0px; list-style-type: none;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 17.12px; color: black; font-family: 宋体; font-size: 12pt;">他</span></strong>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">&nbsp;</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">4、<span style="padding: 0px; margin: 0px; list-style-type: none; line-height: normal; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; font-family: 'Times New Roman'; font-stretch: normal;"><span>&nbsp;</span></span></span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">Redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">是基于内存，那么如果服务器异常了，数据是不是都没有了，丢失了</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt 18pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0cm; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">Redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">为了确保服务器进程退出，数据意外丢失，提供了</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">2</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">种持久化功能：</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">RDB</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">和</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">AOF</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">。该功能可以将</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">在内存中的数据库状态保存到磁盘。从而避免丢失</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">&nbsp;</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">5、<span style="padding: 0px; margin: 0px; list-style-type: none; line-height: normal; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; font-family: 'Times New Roman'; font-stretch: normal;"><span>&nbsp;</span></span></span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">RDB</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">和</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">AOF</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">解释和区别</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt 18pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0cm; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">RDB:</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">可以手动执行，也可以根据服务器配置选项定期执行，可以将某个时间点的数据库状态保存到</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">RDB</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">文件，该文件是一个压缩的二进制文件，通过该文件可以还原生产</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">RDB</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">文件时点的数据库状态，恢复数据</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt 18pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0cm; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">AOF:append only file.</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">与</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">RDB</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">通过保存数据库中健值对来记录数据库状态不同，</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">AOF</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">是通过保存</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">Redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">服务器所执行的写命令来记录数据库状态，因为包含重建数据库状态所需的所有写命令，所有恢复的时候只需要读入并重新执行一遍</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">AOF</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">文件里的保存的写命令就行。</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt 18pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0cm; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">6、<span style="padding: 0px; margin: 0px; list-style-type: none; line-height: normal; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; font-family: 'Times New Roman'; font-stretch: normal;"><span>&nbsp;</span></span></span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">Redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">怎么回收内存（</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">redisobject<span>&nbsp;</span></span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">结构的属性</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">refcount</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">）</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt 18pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0cm; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">Redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">是</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">C</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">语言写的，</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">C</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">语言本身不具备自动内存回收，</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">Redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">在自己的对象系统中构建了一个引用计数实现内存回收机制，如下：</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt 18pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0cm; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">在创建一个新对象是，引用计数的值会被初始化为</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">1</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt 18pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0cm; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">当对象被一个新程序使用时，它的引用计数会被增</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">1</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt 18pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0cm; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">当对象不再被一个程序使用时，它的引用计数值会被减一</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt 18pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0cm; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">当对象的引用计数变为</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">0</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">时，对象所占用的内存会被释放</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt 18pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0cm; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;"><br style="padding: 0px; margin: 0px; list-style-type: none;" /></span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt 18pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0cm; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">7、<span style="padding: 0px; margin: 0px; list-style-type: none; line-height: normal; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; font-family: 'Times New Roman'; font-stretch: normal;"><span>&nbsp;</span></span></span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">reids<span>&nbsp;</span></span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">数据库数据保存</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt 18pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0cm; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">服务器将所有的数据库都保存在</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">redisServer.db</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">数组中，数据库的数量则由</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">redisServer.dbnum</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">属性保存，每个</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">redisdb</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">结构代表一个数据库，每个</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">客户端都有自己的目标数据库，当客户端执行数据库写命令或者读命令时候，目标数据库就会成为这些命令操作对象（目标端可以通过</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">select</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">命令来切换目标数据库）</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt 36pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; text-indent: -18pt; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">8、<span style="padding: 0px; margin: 0px; list-style-type: none; line-height: normal; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; font-family: 'Times New Roman'; font-stretch: normal;"><span>&nbsp;</span></span></span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">键的生存时间和过期时间（</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">EXPIRE</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">、</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">PEXPIRE</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">）</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt 18pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0cm; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">通过给键设置生存时间或者过期时间，来删除键值。使用</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">EXPIRE</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">或</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">PEXPIRE</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">命令给某个键设置过期时间，这个时间是一个</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">unix</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">时间戳，当键的过期时间来临时，服务器就会自动从数据库中删除这个键。当主服务器删除一个过期建时，它会向所有从服务器发送一条</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">DEL</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">命令，删除过期键</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">&nbsp;</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt 36pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; text-indent: -18pt; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">9、<span style="padding: 0px; margin: 0px; list-style-type: none; line-height: normal; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; font-family: 'Times New Roman'; font-stretch: normal;"><span>&nbsp;</span></span></span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">RDB</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">文件生成</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;"><span>&nbsp;</span>SAVE</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">和</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">BGSAVE</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">命令</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt 18pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0cm; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">SAVE</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">名会阻塞</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">服务器进程，直到</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">RDB</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">文件创建完毕为止，服务器进程阻塞期间，服务器不能处理任何命令请求</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt 18pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0cm; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">BGSAVE</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">命令会派生一个子进程，然后由子进程负责创建</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">RDB</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">文件，服务器进程（父进程）继续处理命令请求</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">10</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">、</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">客户端</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">&nbsp;</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; text-indent: 22pt; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">Redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">服务器是典型的一对多服务器程序，一个服务器可以与多个客户端建立网络连接，每个客户端可以向服务器发送命令请求，而服务器接收处理发送的请求并向客户端返回命令回复。输入缓冲区记录了客户端命令请求，缓冲区大小不能超过</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">1GB</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">，如果客户端发送的命令请求超过</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">1GB</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">或者不符合协议格式，客户端将被关闭。同样，如果发送给客户端的命令回复的大小超过了输出缓冲区限制时，对应客户端也会被服务器关闭</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">11</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">、</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">服务器</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt 18pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0cm; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">服务器负责与多个客户端建立连接，处理客户端命令请求，在数据库保存命令执行所产生的数据，通过资源管理维持自身运转</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">12</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">、服务器复制</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">中，用户可以通过执行</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">SLAVEOF</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">命令（或设置选项），让一个服务器去复制另一个服务器，被复制的服务器叫主服务器（</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">master</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">），复制的叫从服务器（</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">slave</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">），主从服务器双方的数据库保存相同的数据（数据库状态一致）</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">13</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">、复制偏移量</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">执行复制的双方，主服务器和从服务器都分部维护一个复制偏移量，比如主从服务器复制偏移量都未</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">10086</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">，主服务器想三个从服务器传播长度为</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">100</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">的字节数据，，主服务器的复制偏移量为</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">10186</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">，三个从服务器在收到主服务器传播的数据后，也会将复制偏移量更新诶</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">10186</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">，通过对比复制偏移量，程序可以很容易的判断主从服务器是否处于一致状态</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">&nbsp;</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">14</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">、复制积压缓冲区</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">复制积压缓冲区是由主服务器维护的一个固定长度先进先出的队列，默认</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">1MB</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">，当主服务器进行命令传播时，它不仅会将写命令发送给所以从服务器，也会将写命令入队到复制积压缓冲区，当从服务器断掉时，重新连接主服务器，根据偏移量来判断，如果偏移量之后的数据还存在复制积压缓冲区，那么主服务器将对从服务器执行部分重同步操作，如果在复制积压缓冲区不存在，则对从服务器执行完整重同步操作</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">&nbsp;</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">15</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">、服务器运行</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">ID</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">除了复制偏移量，复制积压缓冲区，实现部分重同步还需要用到服务器运行</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">ID</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">，每个</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">服务器，不论主从，都有自己的运行</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">ID</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">，运行</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">ID</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">在服务器启动时自动生成，由</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">40</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">个随机的十六进制字符组成，当从服务器对主服务器进行初次复制时，主服务器会将自己的运行</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">ID</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">传送给从服务器，当从服务重新连接上一个主服务器时，从服务器将想当前连接的主服务器发送之前保存的运行</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">ID</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">16</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">、</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">的高可用</span><span>&nbsp;</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">：</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">Sentinel</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">（哨兵）</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">由一个或多个</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">Sentinel</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">实例（</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">instance</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">）组成</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">Sentinel</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">系统，可用监视任意多个主服务器，以及主服务器下的从服务器；并在被监视的主服务器进入下线状态时，自动将下线服务器的某个从服务器升级为新的主服务器，代替原来的主服务器继续处理命令请求。</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">工作原理：当</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">Sentinel</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">监视到主服务器下线时间超过用户设定的时限，就会对主服务器进行故障转移操作，首先会挑选一个从服务器，将其设置为新的主服务器，之后</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">Sentinel</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">会向原来的所有从服务器发送新的复制指令，让他们成为新的主服务器的从服务器，当所有从服务器开始复制新的主服务器时，故障转移操作执行完毕。同时</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">Sentinel</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">会继续监视已经下线的原主服务器，并在它重新上线时，将它设置为新的主服务器的从服务器（</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">Sentinel</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">是一个运行在特殊模式下的</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">服务器，当一个主服务器被判断为下线时，监视的各</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">Sentinel</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">会进行协商，选举一个领头</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">Sentinel</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">，并由领头</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">Sentinel</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">对下线主服务器执行故障转移操作，选举规则是先到先得和半数通过）</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">17</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">、</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">Redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">集群</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">Redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">集群是</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">Redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">提供的分布式数据库方案，集群通过分片（</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">sharding</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">）来进行数据共享，并提供复制和故障转移功能</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">17.1<span>&nbsp;</span></span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">节点：一个</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">集群由多个节点（</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">node</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">）组成，相互独立的节点通过握手（</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">IP</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">和</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">port</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">）（</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">cluster meet</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">命令），连接起来后组成集群，一个节点就是一个运行在</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">集群模式下</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">服务器，</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">服务器通过</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">cluster-enabled</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">配置项是否为</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">Yes</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">来决定是否开启服务器集群模式</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">17.2 cluster meet</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">命令实现</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">通过向节点</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">A</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">发送</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">cluster meet</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">命令，，客户端让接收命令的节点</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">A</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">将另一个节点</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">B</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">添加到</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">A</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">所在的集群里面，首先</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">A</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">与</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">B</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">进行握手，确定彼此存在，节点</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">A</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">为节点</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">B</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">创建一个</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">clusternode</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">结构，并将该结构添加到自己的</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">clusterstate.nodes</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">字典里面，然后节点</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">A</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">将根据</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">cluster meet</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">命令给定的</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">IP<span>&nbsp;</span></span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">地址和端口号，先节点</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">B</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">发送</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">meet</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">消息，节点</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">B</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">收到</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">A</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">的</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">meet</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">消息后，为</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">A</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">创建</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">clusternode</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">结构，添加到自己的</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">clusterstate.nodes</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">字典里面，向节点</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">A</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">返回一条</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">pong</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">消息，节点</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">A</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">收到消息后，确定了节点</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">B</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">成功收到了自己的</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">meet</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">消息，之后节点</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">A</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">想节点</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">B</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">返回一条</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">ping</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">消息，节点</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">B</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">收到</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">ping</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">消息后，确定</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">A</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">接收到了自己的</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">pong</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">消息，握手完成。之后，节点</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">A</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">将节点</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">B</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">的信息通过</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">gossip</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">协议传播给集群中的其他节点，让其他节点与</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">B</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">握手，直到</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">B</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">为集群所有节点认识</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">&nbsp;</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">17.3</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">槽指派</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">Redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">集群通过<span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; background: yellow;">分片</span>的方式来保存数据库中的键值对，集群整个数据库被分为</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">16384</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">个槽（</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">slot</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">）的，数据库中的每个键都属于这</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">16384</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">个槽的其中一个，每个节点可以处理</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">0</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">个或者最多</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">16384</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">个槽。当数据库中的</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">16384</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">个槽都有节点在处理时，集群处于上线状态，如果任何一个槽没有得到处理，集群处于下行状态（</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">fail</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">）。</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">一个节点会将自己负责处理的槽记录在</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">clusternode</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">结构的</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">slot</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">属性和</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">numlots</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">属性中，同时将自己的</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">slots</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">数组通过消息发送给集群其他节点，以此告知其他节点自己负责处理哪些槽，举例：</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">01</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">，</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">02,03<span>&nbsp;</span></span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">三个节点组成一个集群，槽</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">0-5000</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">分给</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">01</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">节点，槽</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">5001-10000</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">分给</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">02</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">节点，</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">10001-16383</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">分给</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">03</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">节点，对应的节点只处理自己负责的槽。收到命令时，如果键所在的槽正好是当前节点，就直接处理命令，否则想客户端返回一个</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">moved</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">错误，指引客户端转向正确的节点</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">Reids</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">集群管理软件</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">reids-trib</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">可以对</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">进行重新分片，可以</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">on line</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">进行，集群不需下线</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">17.4<span>&nbsp;</span></span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">集群的复制和故障转移</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">Redis</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">集群的节点分为主节点（</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">master</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">）和从节点（</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">slave</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">），分配了槽的是主节点，从节点用于复制某个主节点，并在被复制的主节点下线时，代替下线主节点继续处理命令请求。</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">举例：</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">01,02,03</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">是主节点，分配了槽，</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">04,05,06</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">是从节点，如果</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">01</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">处于下线状态，那么集群中仍在运行的几个主节点将在</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">01</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">节点的从节点中选择一个节点做为新的主节点，接管原来</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">01</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">节点处理的槽</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">.</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">故障检测：集群中每个节点都会定期向集群中的其他节点发送</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">ping</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">消息，如果接收</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">ping</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">消息的节点没有在规定时间内，返回</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">pong</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">消息，那么该节点就会标记为疑似下线。一旦半数以上主节点判断某个主节点为疑似下线，那么该主节点将被标记为已下线。（投票规则），当从节点发现自己负责的主节点进入了下线状态时，从节点将开始对下线的主节点进行故障转移。其中一个从节点被选中为新的主节点，新的主节点会撤销下线主节点的槽指派，并将这些槽指派给自己，新主节点向集群广播一条</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">pong</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">消息，知会其他节点</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">17.5<span>&nbsp;</span></span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">消息</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">集群中各个节点通过发送和接收消息进行通信，</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">GOSSIP</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">协议由</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">meet</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">，</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">ping</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">，</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">pong</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">三种消息实现。</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">Ping</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">消息，检查节点是否在线；</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">pong</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">消息，接收者向发送者返回</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">pong</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">消息，确认消息收到，</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">meet</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">消息，</span><span>&nbsp;</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">集群握手</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">18</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">、慢查询日志</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Reids</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">的慢查询日志功能用户记录执行时间超过给定时长的命令请求，用户通过这个功能查收的日志来减少和优化查询速度</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">服务器配置有</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">2</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">个和慢查询日志相关的选项</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">Slowlog-log-slower-than<span>&nbsp;</span></span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">，该选项指定执行时间超过多少微妙的命令请求会被记录到日志上（</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">1</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">秒</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">=100</span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">万微妙）</span>
			</p>
			<p style="padding: 0px; margin: 0cm 0cm 8pt; list-style-type: none; line-height: 15.6933px; font-size: 11pt; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; font-family: Calibri, sans-serif;"><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em;">Slowlog-max-len<span>&nbsp;</span></span><span style="padding: 0px; margin: 0px; list-style-type: none; line-height: 1.8em; font-family: 宋体;">该选择指定服务器最多保存多少条慢查询日志</span>
			</p>
		</div>
	</body>
</html>
